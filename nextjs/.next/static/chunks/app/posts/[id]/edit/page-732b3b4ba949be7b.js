(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[136],{4737:function(e,s,t){Promise.resolve().then(t.bind(t,6401))},6401:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var a=t(7437),n=t(2265),l=t(5806),r=t(4033),i=t(6763),c=t(1396),d=t.n(c);function o(e){let{params:s}=e,{user:t}=(0,l.useAuth)(),c=(0,r.useRouter)(),[o,u]=(0,n.useState)(null),[h,m]=(0,n.useState)(""),[x,b]=(0,n.useState)(""),[p,v]=(0,n.useState)(!0),[f,j]=(0,n.useState)(!1),[N,g]=(0,n.useState)("");(0,n.useEffect)(()=>{I()},[s.id]);let I=async()=>{let{data:e,error:t}=await i.O.from("posts").select("*").eq("id",s.id).maybeSingle();t?(console.error("Error fetching post:",t),v(!1)):e&&(u(e),m(e.title),b(e.content),v(!1))},S=async e=>{if(e.preventDefault(),!t||!o)return;j(!0),g("");let{error:a}=await i.O.from("posts").update({title:h,content:x,updated_at:new Date().toISOString()}).eq("id",s.id);a?(g(a.message),j(!1)):c.push("/posts/".concat(s.id))};return p?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("span",{className:"loading loading-spinner loading-lg"})}):o&&o.user_id===(null==t?void 0:t.id)?(0,a.jsxs)("div",{className:"min-h-screen bg-base-200",children:[(0,a.jsx)("div",{className:"navbar bg-base-100 shadow-lg",children:(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(d(),{href:"/posts",className:"btn btn-ghost normal-case text-xl",children:"Post Manager"})})}),(0,a.jsx)("div",{className:"container mx-auto p-4 max-w-2xl",children:(0,a.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsx)("h2",{className:"card-title text-2xl mb-4",children:"Edit Post"}),N&&(0,a.jsx)("div",{className:"alert alert-error mb-4",children:(0,a.jsx)("span",{children:N})}),(0,a.jsxs)("form",{onSubmit:S,children:[(0,a.jsxs)("div",{className:"form-control mb-4",children:[(0,a.jsx)("label",{className:"label",children:(0,a.jsx)("span",{className:"label-text",children:"Title"})}),(0,a.jsx)("input",{type:"text",placeholder:"Enter post title",className:"input input-bordered",value:h,onChange:e=>m(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"form-control mb-6",children:[(0,a.jsx)("label",{className:"label",children:(0,a.jsx)("span",{className:"label-text",children:"Content"})}),(0,a.jsx)("textarea",{placeholder:"Enter post content",className:"textarea textarea-bordered h-32",value:x,onChange:e=>b(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"submit",className:"btn btn-primary ".concat(f?"loading":""),disabled:f,children:f?"Saving...":"Save Changes"}),(0,a.jsx)(d(),{href:"/posts/".concat(s.id),className:"btn btn-ghost",children:"Cancel"})]})]})]})})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-base-200",children:[(0,a.jsx)("div",{className:"navbar bg-base-100 shadow-lg",children:(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(d(),{href:"/posts",className:"btn btn-ghost normal-case text-xl",children:"Post Manager"})})}),(0,a.jsx)("div",{className:"container mx-auto p-4",children:(0,a.jsx)("div",{className:"alert alert-error",children:(0,a.jsx)("span",{children:o?"You do not have permission to edit this post":"Post not found"})})})]})}},5806:function(e,s,t){"use strict";t.r(s),t.d(s,{AuthProvider:function(){return c},useAuth:function(){return d}});var a=t(7437),n=t(2265),l=t(6763),r=t(4033);let i=(0,n.createContext)({});function c(e){let{children:s}=e,[t,c]=(0,n.useState)(null),[d,o]=(0,n.useState)(!0),u=(0,r.useRouter)();(0,n.useEffect)(()=>{l.O.auth.getSession().then(e=>{var s;let{data:{session:t}}=e;c(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null),o(!1)});let{data:{subscription:e}}=l.O.auth.onAuthStateChange((e,s)=>{var t;c(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null)});return()=>e.unsubscribe()},[]);let h=async(e,s)=>{let{error:t}=await l.O.auth.signUp({email:e,password:s});return{error:t}},m=async(e,s)=>{let{error:t}=await l.O.auth.signInWithPassword({email:e,password:s});return{error:t}},x=async()=>{await l.O.auth.signOut(),u.push("/auth/signin")};return(0,a.jsx)(i.Provider,{value:{user:t,loading:d,signUp:h,signIn:m,signOut:x},children:s})}let d=()=>(0,n.useContext)(i)},6763:function(e,s,t){"use strict";t.d(s,{O:function(){return n}});var a=t(5257);let n=(0,a.eI)("https://jsmewescgnvfbevdnuqx.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpzbWV3ZXNjZ252ZmJldmRudXF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4NDQxMTksImV4cCI6MjA3NzQyMDExOX0.HFUEr-FR97YIw_eWQab8oJK7ZvtLWXBEuY_RqVTd_1I")},1396:function(e,s,t){e.exports=t(4724)}},function(e){e.O(0,[850,724,971,864,744],function(){return e(e.s=4737)}),_N_E=e.O()}]);